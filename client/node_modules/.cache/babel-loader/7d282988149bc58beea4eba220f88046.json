{"ast":null,"code":"var _jsxFileName = \"/Users/andershornor/Class_Work/ReadThat1/client/src/containers/MainPage.jsx\";\nimport React, { Component } from 'react';\nimport Login from '../components/forms/Login';\nimport Feed from './Feed';\nimport NewUser from '../components/forms/NewUser';\nimport { userLogin, userLogout, newUser, pageReload } from '../actions/userActions';\nimport { connect } from 'react-redux'; // import { BrowserRouter as Router, Route, Redirect } from \"react-router-dom\";\n\nimport history from '../history';\nexport const API = 'http://localhost:3000/';\n\nclass MainPage extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      input: '',\n      password: '',\n      passwordConfirmation: '',\n      username: '',\n      isNewUser: false // token: null,\n      // isLoggedIn: false,\n      // currentUser: null\n\n    };\n\n    this.logOut = () => {\n      this.props.userLogout();\n    };\n\n    this.handleChange = e => {\n      let key = e.target.name;\n      let newState = e.target.value;\n      this.setState({\n        [key]: newState\n      });\n    };\n\n    this.onNewUserSubmit = e => {\n      this.props.newUser(e); // const { username, password, passwordConfirmation } = this.state;\n      // e.preventDefault();\n      // fetch(API + 'users', {\n      // \tmethod: 'POST',\n      // \theaders: { 'Content-Type': 'application/json', Accept: 'application/json' },\n      // \tbody: JSON.stringify({\n      // \t\tuser: {\n      // \t\t\tusername: username,\n      // \t\t\tpassword: password,\n      // \t\t\tpassword_confirmation: passwordConfirmation\n      // \t\t}\n      // \t})\n      // })\n      // \t.then(res => res.json())\n      // \t.then(res => {\n      // \t\tres.error\n      // \t\t\t? alert(res.error)\n      // \t\t\t: this.setState({\n      // \t\t\t\t\tcurrentUser: res,\n      // \t\t\t\t\tisLoggedIn: true,\n      // \t\t\t\t\ttoken: res.token,\n      // \t\t\t\t\tpassword: '',\n      // \t\t\t\t\tpasswordConfirmation: ''\n      // \t\t\t  });\n      // \t})\n      // \t.then(res => localStorage.setItem('user-token', this.state.token));\n    };\n\n    this.onLoginSubmit = async e => {\n      this.props.userLogin(e); // const { username, password } = this.state;\n      // e.preventDefault();\n      // await fetch(API + 'login', {\n      // \tmethod: 'POST',\n      // \theaders: { 'Content-Type': 'application/json', Accept: 'application/json' },\n      // \tbody: JSON.stringify({ user: { username: username, password: password } })\n      // })\n      // \t.then(res => res.json())\n      // \t.then(res => {\n      // \t\tres.errors ? \n      // \t\talert(res.errors)\n      // \t\t:\n      // \t\tthis.setState({\n      // \t\t\tcurrentUser: res,\n      // \t\t\tisLoggedIn: true,\n      // \t\t\ttoken: res.token,\n      // \t\t\tpassword: '',\n      // \t\t\tpasswordConfirmation: ''\n      // \t\t})\n      // \t}\n      // \t)\n      // \tif(this.state.token !== null){\n      // \t\tlocalStorage.setItem('user-token', this.state.token);\n      // \t}\n    };\n\n    this.newUserModalHandler = () => {\n      this.setState({\n        isNewUser: true\n      });\n    };\n\n    this.conditionalRender = () => {\n      let Component;\n      const _this$state = this.state,\n            isLoggedIn = _this$state.isLoggedIn,\n            isNewUser = _this$state.isNewUser,\n            currentUser = _this$state.currentUser,\n            token = _this$state.token;\n\n      if (!isLoggedIn) {\n        if (isNewUser) {\n          history.push('/new-user');\n          Component = React.createElement(NewUser, {\n            handleChange: this.handleChange,\n            onSubmit: this.onNewUserSubmit,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 116\n            },\n            __self: this\n          });\n        } else {\n          history.push('/login');\n          Component = React.createElement(Login, {\n            handleChange: this.handleChange,\n            onClick: this.newUserClickHandler,\n            onSubmit: this.onLoginSubmit,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 120\n            },\n            __self: this\n          });\n        }\n      } else if (isLoggedIn) {\n        history.push('/feed');\n        Component = React.createElement(Feed, {\n          currentUser: currentUser,\n          token: token,\n          logOut: this.logOut,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129\n          },\n          __self: this\n        });\n      } else {\n        history.push('/login');\n        Component = React.createElement(Login, {\n          handleChange: this.handleChange,\n          onClick: this.newUserClickHandler,\n          onSubmit: this.onLoginSubmit,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 133\n          },\n          __self: this\n        });\n      }\n\n      return Component;\n    };\n  }\n\n  componentDidMount() {// if(localStorage.getItem('user-token') !== \"undefined\" && localStorage.getItem('user-token') !== null) {\n    // \tfetch(`${API}users/current_user`, {\n    // \t\theaders: {\n    // \t\t'Authorization': `Bearer ${localStorage.getItem('user-token')}`,\n    // \t\t'Content-Type': 'application/json',\n    // \t\tAccept: 'application/json'}\n    // \t})\n    // \t.then(res => res.json())\n    // \t.then(res => dispatch({currentUser: res, isLoggedIn: true, token: res.token}))\n    // }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"main-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, this.conditionalRender());\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  currentUser: state.user.currentUser,\n  isLoggedIn: state.user.isLoggedIn,\n  token: state.user.token\n});\n\nexport default connect(mapStateToProps, {\n  userLogin,\n  userLogout,\n  newUser,\n  pageReload\n})(MainPage);","map":{"version":3,"sources":["/Users/andershornor/Class_Work/ReadThat1/client/src/containers/MainPage.jsx"],"names":["React","Component","Login","Feed","NewUser","userLogin","userLogout","newUser","pageReload","connect","history","API","MainPage","state","input","password","passwordConfirmation","username","isNewUser","logOut","props","handleChange","e","key","target","name","newState","value","setState","onNewUserSubmit","onLoginSubmit","newUserModalHandler","conditionalRender","isLoggedIn","currentUser","token","push","newUserClickHandler","componentDidMount","render","mapStateToProps","user"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Login from '../components/forms/Login';\nimport Feed from './Feed';\nimport NewUser from '../components/forms/NewUser';\nimport { userLogin, userLogout, newUser, pageReload } from '../actions/userActions'\nimport { connect } from 'react-redux'\n// import { BrowserRouter as Router, Route, Redirect } from \"react-router-dom\";\nimport history from '../history';\n\nexport const API = 'http://localhost:3000/';\n\nclass MainPage extends Component {\n\tstate = {\n\t\tinput: '',\n\t\tpassword: '',\n\t\tpasswordConfirmation: '',\n\t\tusername: '',\n\t\tisNewUser: false,\n\t\t// token: null,\n\t\t// isLoggedIn: false,\n\t\t// currentUser: null\n\t};\n\n\tcomponentDidMount(){\n\t\t// if(localStorage.getItem('user-token') !== \"undefined\" && localStorage.getItem('user-token') !== null) {\n\t\t// \tfetch(`${API}users/current_user`, {\n\t\t// \t\theaders: {\n\t\t// \t\t'Authorization': `Bearer ${localStorage.getItem('user-token')}`,\n\t\t// \t\t'Content-Type': 'application/json',\n\t\t// \t\tAccept: 'application/json'}\n\t\t// \t})\n\t\t// \t.then(res => res.json())\n\t\t// \t.then(res => dispatch({currentUser: res, isLoggedIn: true, token: res.token}))\n\t\t// }\n\t}\n\n\tlogOut = () => {\n\t\tthis.props.userLogout()\n\t}\n\n\thandleChange = e => {\n\t\tlet key = e.target.name;\n\t\tlet newState = e.target.value;\n\t\tthis.setState({ [key]: newState });\n\t};\n\n\tonNewUserSubmit = e => {\n\t\tthis.props.newUser(e)\n\t\t// const { username, password, passwordConfirmation } = this.state;\n\t\t// e.preventDefault();\n\t\t// fetch(API + 'users', {\n\t\t// \tmethod: 'POST',\n\t\t// \theaders: { 'Content-Type': 'application/json', Accept: 'application/json' },\n\t\t// \tbody: JSON.stringify({\n\t\t// \t\tuser: {\n\t\t// \t\t\tusername: username,\n\t\t// \t\t\tpassword: password,\n\t\t// \t\t\tpassword_confirmation: passwordConfirmation\n\t\t// \t\t}\n\t\t// \t})\n\t\t// })\n\t\t// \t.then(res => res.json())\n\t\t// \t.then(res => {\n\t\t// \t\tres.error\n\t\t// \t\t\t? alert(res.error)\n\t\t// \t\t\t: this.setState({\n\t\t// \t\t\t\t\tcurrentUser: res,\n\t\t// \t\t\t\t\tisLoggedIn: true,\n\t\t// \t\t\t\t\ttoken: res.token,\n\t\t// \t\t\t\t\tpassword: '',\n\t\t// \t\t\t\t\tpasswordConfirmation: ''\n\t\t// \t\t\t  });\n\t\t// \t})\n\t\t// \t.then(res => localStorage.setItem('user-token', this.state.token));\n\t};\n\n\tonLoginSubmit = async (e) => {\n\t\tthis.props.userLogin(e)\n\t\t// const { username, password } = this.state;\n\t\t// e.preventDefault();\n\t\t// await fetch(API + 'login', {\n\t\t// \tmethod: 'POST',\n\t\t// \theaders: { 'Content-Type': 'application/json', Accept: 'application/json' },\n\t\t// \tbody: JSON.stringify({ user: { username: username, password: password } })\n\t\t// })\n\t\t// \t.then(res => res.json())\n\t\t// \t.then(res => {\n\t\t// \t\tres.errors ? \n\t\t// \t\talert(res.errors)\n\t\t// \t\t:\n\t\t// \t\tthis.setState({\n\t\t// \t\t\tcurrentUser: res,\n\t\t// \t\t\tisLoggedIn: true,\n\t\t// \t\t\ttoken: res.token,\n\t\t// \t\t\tpassword: '',\n\t\t// \t\t\tpasswordConfirmation: ''\n\t\t// \t\t})\n\t\t// \t}\n\t\t// \t)\n\t\t// \tif(this.state.token !== null){\n\t\t// \t\tlocalStorage.setItem('user-token', this.state.token);\n\t\t// \t}\n\t};\n\t//\n\n\tnewUserModalHandler = () => {\n\t\tthis.setState({ isNewUser: true });\n\t};\n\n\tconditionalRender = () => {\n\t\tlet Component;\n\t\tconst { isLoggedIn, isNewUser, currentUser, token } = this.state;\n\t\tif (!isLoggedIn) {\n\t\t\tif (isNewUser) {\n\t\t\t\thistory.push('/new-user');\n\t\t\t\tComponent = <NewUser handleChange={this.handleChange} onSubmit={this.onNewUserSubmit} />;\n\t\t\t} else {\n\t\t\t\thistory.push('/login');\n\t\t\t\tComponent = (\n\t\t\t\t\t<Login\n\t\t\t\t\t\thandleChange={this.handleChange}\n\t\t\t\t\t\tonClick={this.newUserClickHandler}\n\t\t\t\t\t\tonSubmit={this.onLoginSubmit}\n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\t}\n\t\t} else if (isLoggedIn){\n\t\t\thistory.push('/feed');\n\t\t\tComponent = <Feed currentUser={currentUser} token={token} logOut={this.logOut} />;\n\t\t} else {\n\t\t\thistory.push('/login');\n\t\t\t\tComponent = (\n\t\t\t\t\t<Login\n\t\t\t\t\t\thandleChange={this.handleChange}\n\t\t\t\t\t\tonClick={this.newUserClickHandler}\n\t\t\t\t\t\tonSubmit={this.onLoginSubmit}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\treturn Component;\n\t};\n\n\trender() {\n\t\treturn <div className='main-container'>{this.conditionalRender()}</div>;\n\t}\n}\n\nconst mapStateToProps = state => ({\n\tcurrentUser: state.user.currentUser,\n\tisLoggedIn: state.user.isLoggedIn,\n\ttoken: state.user.token\n})\n\nexport default connect(mapStateToProps, { userLogin, userLogout, newUser, pageReload })(MainPage)\n\n"]},"metadata":{},"sourceType":"module"}