{"ast":null,"code":"import { FETCH_POSTS, NEW_POST, SELECT_POSTS, CLEAR_POST_SELECTION, FILTER_POSTS } from './types';\nimport { API } from '../containers/MainPage';\nexport const fetchPosts = () => async (dispatch, getState) => {\n  const selectedCategories = getState().categories.selectedCategories;\n  const token = localStorage.getItem('user-token');\n  await dispatch({\n    type: CLEAR_POST_SELECTION\n  });\n\n  if (selectedCategories.length < 1) {\n    fetch(\"\".concat(API, \"posts\"), {\n      headers: {\n        Authorization: \"Bearer \".concat(token)\n      }\n    }).then(res => res.json()).then(posts => dispatch({\n      type: FETCH_POSTS,\n      payload: posts\n    }));\n  } else {\n    selectedCategories.forEach(category => {\n      fetch(\"\".concat(API, \"categories/\").concat(category.value), {\n        headers: {\n          Authorization: \"Bearer \".concat(token)\n        }\n      }).then(res => res.json()).then(posts => dispatch({\n        type: SELECT_POSTS,\n        payload: posts\n      }));\n    });\n  }\n};\nexport const filterPosts = () => async (dispatch, getState) => {\n  const voteCount = getState().votes.voteCount;\n  let posts = getState().posts.posts;\n  const selectedPosts = getState().posts.selectedPosts;\n  let placeholder = [];\n  let keys = Object.keys(voteCount);\n  keys.sort((a, b) => {\n    return voteCount[a] - voteCount[b];\n  });\n  let filteredPosts = keys.map(key => {\n    return {\n      [key]: voteCount[key]\n    };\n  });\n\n  if (selectedPosts.length > 0) {\n    posts = selectedPosts;\n  }\n\n  await filteredPosts.forEach(post => {\n    if (Object.values(post) > 0 && posts.find(pos => {\n      return pos.id === Object.keys(post) * 1;\n    })) {\n      placeholder.unshift(posts.find(pos => {\n        return pos.id === Object.keys(post) * 1;\n      }));\n    }\n  });\n  await posts.forEach(post => {\n    if (!placeholder.includes(post)) {\n      placeholder.push(post);\n    }\n  });\n  await filteredPosts.reverse();\n  await filteredPosts.forEach(post => {\n    if (Object.values(post) < 0 && posts.find(pos => {\n      return pos.id === Object.keys(post) * 1;\n    })) {\n      placeholder.push(posts.find(pos => {\n        return pos.id === Object.keys(post) * 1;\n      }));\n    }\n  });\n  const output = Array.from(new Set(placeholder.map(a => a.id))).map(id => {\n    return placeholder.find(a => a.id === id);\n  });\n\n  if (getState().posts.howToFilterBool) {\n    placeholder.reverse();\n  }\n\n  debugger; // dispatch({\n  //     type: FILTER_POSTS,\n  //     payload: output\n  // })\n};\nexport const createPost = post => async dispatch => {\n  const token = localStorage.getItem('user-token');\n  await fetch(\"\".concat(API, \"posts\"), {\n    method: 'POST',\n    headers: {\n      Authorization: \"Bearer \".concat(token),\n      'Content-type': 'Application/JSON'\n    },\n    body: JSON.stringify({\n      post: post\n    })\n  }).then(res => res.json()).then(post => post.errors ? window.alert(post.errors) : dispatch({\n    type: NEW_POST,\n    payload: post\n  }));\n};","map":{"version":3,"sources":["/Users/andershornor/Class_Work/ReadThat1/client/src/actions/postActions.jsx"],"names":["FETCH_POSTS","NEW_POST","SELECT_POSTS","CLEAR_POST_SELECTION","FILTER_POSTS","API","fetchPosts","dispatch","getState","selectedCategories","categories","token","localStorage","getItem","type","length","fetch","headers","Authorization","then","res","json","posts","payload","forEach","category","value","filterPosts","voteCount","votes","selectedPosts","placeholder","keys","Object","sort","a","b","filteredPosts","map","key","post","values","find","pos","id","unshift","includes","push","reverse","output","Array","from","Set","howToFilterBool","createPost","method","body","JSON","stringify","errors","window","alert"],"mappings":"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","sourcesContent":["import { FETCH_POSTS, NEW_POST, SELECT_POSTS, CLEAR_POST_SELECTION, FILTER_POSTS } from './types'\nimport { API } from '../containers/MainPage'\n\nexport const fetchPosts = () => async (dispatch, getState) => {\n        const { selectedCategories } = getState().categories\n        const token = localStorage.getItem('user-token');\n        await dispatch({\n            type: CLEAR_POST_SELECTION,\n        })\n\t\tif (selectedCategories.length < 1) {\n\t\t\tfetch(`${API}posts`, {\n\t\t\t\theaders: { Authorization: `Bearer ${token}` }\n\t\t\t})\n\t\t\t\t.then(res => res.json())\n\t\t\t\t.then(posts => dispatch({\n                    type: FETCH_POSTS,\n                    payload: posts\n                }));\n\t\t} else {\n            selectedCategories.forEach(category => {\n\t\t\t\tfetch(`${API}categories/${category.value}`, {\n\t\t\t\t\theaders: { Authorization: `Bearer ${token}` }\n\t\t\t\t})\n                    .then(res => res.json())\n                    .then(posts => dispatch({\n                        type: SELECT_POSTS,\n                        payload: posts}))   \n            })\n \n\t\t}\n    };\n\nexport const filterPosts = () => async (dispatch, getState) => {\n   \n    const { voteCount } = getState().votes\n    let { posts } = getState().posts\n    const { selectedPosts } = getState().posts\n    let placeholder = []\n    let keys = Object.keys(voteCount)\n    keys.sort((a, b) => {return voteCount[a] - voteCount[b]})\n    let filteredPosts = keys.map(key => {\n        return {[key]: voteCount[key]}\n    })\n\n    if (selectedPosts.length > 0){\n        posts = selectedPosts\n    }\n\n    await filteredPosts.forEach(post => {\n        if (Object.values(post) > 0 && posts.find( pos => {return pos.id === Object.keys(post)*1})){\n            placeholder.unshift(posts.find( pos => {return pos.id === Object.keys(post)*1}))\n        }\n    })\n\n    await posts.forEach(post =>{\n        if(!placeholder.includes(post)) {\n            placeholder.push(post)\n        }\n    })\n\n    await filteredPosts.reverse()\n    await filteredPosts.forEach(post => {\n        if (Object.values(post) < 0 && posts.find( pos => {return pos.id === Object.keys(post)*1})){\n            placeholder.push(posts.find( pos => {return pos.id === Object.keys(post)*1}))\n        }\n    })\n\n    const output = Array.from(new Set(placeholder.map(a => a.id))).map(id => {\n        return placeholder.find(a => a.id === id)\n    })\n\n    if (getState().posts.howToFilterBool){\n        placeholder.reverse()\n    }\n    debugger\n\n    // dispatch({\n    //     type: FILTER_POSTS,\n    //     payload: output\n    // })\n\n}\n\nexport const createPost = (post) => async (dispatch) => {\n    const token = localStorage.getItem('user-token')\n    await fetch(`${API}posts`, {\n        method: 'POST',\n        headers: { \n            Authorization: `Bearer ${token}`,\n            'Content-type': 'Application/JSON',\n        },\n        body: JSON.stringify({post: post})\n    })\n    .then(res => res.json())\n    .then(post => post.errors ? window.alert(post.errors) : dispatch({\n        type: NEW_POST,\n        payload: post\n    }))\n}\n\n"]},"metadata":{},"sourceType":"module"}